<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Modal Blinking Test</h2>
        <p>Click the buttons below to test if modals are blinking</p>
        
        <div class="row">
            <div class="col-md-6">
                <h4>Fee Modal (Working Reference)</h4>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#feeModal">
                    Open Fee Modal (No Blink)
                </button>
            </div>
            
            <div class="col-md-6">
                <h4>Business Modal (Test)</h4>
                <button type="button" class="btn btn-warning" 
                        data-bs-toggle="modal" 
                        data-bs-target="#businessModal"
                        data-business-data='{"id":1,"name":"Test Business"}'>
                    Open Business Modal (Should Not Blink)
                </button>
            </div>
        </div>
        
        <div class="mt-4">
            <h4>Asset Modal (Test)</h4>
            <button type="button" class="btn btn-success" 
                    data-bs-toggle="modal" 
                    data-bs-target="#assetModal"
                    data-asset-id="1"
                    data-asset-type="2"
                    data-business-id=""
                    data-quantity="5"
                    data-value="100000">
                Open Asset Modal (Should Not Blink)
            </button>
        </div>
    </div>

    <!-- Fee Modal (Reference) -->
    <div class="modal fade" id="feeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content" style="background-color: white;">
                <div class="modal-header">
                    <h5 class="modal-title">Fee Payment (Reference)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>This is the fee modal that works correctly without blinking.</p>
                    <div class="mb-3">
                        <label class="form-label">Amount</label>
                        <input type="number" class="form-control" placeholder="Enter amount">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Business Modal (Test) -->
    <div class="modal fade" id="businessModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content" style="background: white; border-radius: 15px; border: none; box-shadow: 0 10px 40px rgba(0,0,0,0.1);">
                <div class="modal-header" style="background-color: white; border-bottom: 1px solid #dee2e6;">
                    <h5 class="modal-title" style="color: #000;">Edit Business</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="background-color: white;">
                    <p>Business ID: <span id="businessId"></span></p>
                    <p>Business Name: <span id="businessName"></span></p>
                    <div class="mb-3">
                        <label class="form-label" style="color: #000;">Business Name</label>
                        <input type="text" id="edit_name" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label class="form-label" style="color: #000;">Registration No</label>
                        <input type="text" class="form-control">
                    </div>
                </div>
                <div class="modal-footer" style="background-color: white; border-top: 1px solid #dee2e6;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-warning">Update</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Asset Modal (Test) -->
    <div class="modal fade" id="assetModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog">
            <div class="modal-content" style="background: white; border-radius: 15px; border: none; box-shadow: 0 10px 40px rgba(0,0,0,0.1);">
                <div class="modal-header" style="background-color: white; border-bottom: 1px solid #dee2e6;">
                    <h5 class="modal-title" style="color: #000;">Edit Asset</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="background-color: white;">
                    <p>Asset ID: <span id="assetId"></span></p>
                    <div class="mb-3">
                        <label class="form-label" style="color: #000;">Quantity</label>
                        <input type="number" id="edit_quantity" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label class="form-label" style="color: #000;">Value</label>
                        <input type="number" id="edit_value" class="form-control">
                    </div>
                </div>
                <div class="modal-footer" style="background-color: white; border-top: 1px solid #dee2e6;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-warning">Update</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Business Modal - Populate on show
            const businessModal = document.getElementById('businessModal');
            if (businessModal) {
                businessModal.addEventListener('show.bs.modal', function (event) {
                    const button = event.relatedTarget;
                    const businessData = JSON.parse(button.getAttribute('data-business-data'));
                    
                    document.getElementById('businessId').textContent = businessData.id;
                    document.getElementById('businessName').textContent = businessData.name;
                    document.getElementById('edit_name').value = businessData.name || '';
                });
            }

            // Asset Modal - Populate on show
            const assetModal = document.getElementById('assetModal');
            if (assetModal) {
                assetModal.addEventListener('show.bs.modal', function (event) {
                    const button = event.relatedTarget;
                    const id = button.getAttribute('data-asset-id');
                    const quantity = button.getAttribute('data-quantity');
                    const value = button.getAttribute('data-value');
                    
                    document.getElementById('assetId').textContent = id;
                    document.getElementById('edit_quantity').value = quantity;
                    document.getElementById('edit_value').value = value;
                });
            }
        });
    </script>

    <style>
        /* Fix modal blinking/flickering */
        .modal.fade .modal-dialog {
            transition: transform 0.3s ease-out;
        }

        .modal-backdrop.fade {
            transition: opacity 0.15s linear;
        }

        .modal {
            overflow-x: hidden;
            overflow-y: auto;
        }

        body.modal-open {
            overflow: hidden;
        }
    </style>
</body>
</html>
